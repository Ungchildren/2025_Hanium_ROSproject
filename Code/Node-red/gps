#function

// null-safe formatter
function toFixedOrDash(val, digits = 6) {
    return (typeof val === "number" && !isNaN(val)) ? val.toFixed(digits) : "-";
}

// MongoDB ê²°ê³¼ê°€ ë°°ì—´ì´ë¯€ë¡œ ì²« ë²ˆì§¸ ë¬¸ì„œë¥¼ êº¼ëƒ„
let doc = (Array.isArray(msg.payload) && msg.payload.length > 0) ? msg.payload[0] : {};

msg.payload = {
    latitude: toFixedOrDash(doc.latitude),
    longitude: toFixedOrDash(doc.longitude),
    timestamp: new Date(doc.timestamp * 1000).toLocaleString(),
    status: doc.status || "-"
};

return msg;


#UI
<div style="padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px;">
  <div style="color:#00CED1; font-weight: bold; margin-bottom: 8px;">ğŸ“¡ GPS Data</div>
  <table style="width: 100%; font-size: 15px;">
    <tr>
      <td>ìœ„ë„:</td>
      <td style="text-align: right; font-weight: bold;">{{msg.payload.latitude}}Â°</td>
    </tr>
    <tr>
      <td>ê²½ë„:</td>
      <td style="text-align: right; font-weight: bold;">{{msg.payload.longitude}}Â°</td>
    </tr>
    <tr>
      <td>ìƒíƒœ:</td>
      <td style="text-align: right; font-weight: bold;">
        <span ng-if="msg.payload.status === 'ì •ìƒ' || msg.payload.status === 'OK'" style="color: green;">
          ì‹¤ì™¸ì— ìœ„ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.
        </span>
        <span ng-if="msg.payload.status !== 'ì •ìƒ' && msg.payload.status !== 'OK'" style="color: red;">
          GPS ë¯¸ì§€ì› ì§€ì—­ì…ë‹ˆë‹¤.
        </span>
      </td>
    </tr>
  </table>
</div>
